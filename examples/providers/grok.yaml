# Grok Provider Configuration
#
# AutomatosX supports two Grok endpoints:
# 1. X.AI Official Grok (grok-3-fast) - Default, recommended
# 2. Z.AI GLM 4.6 (code-optimized) - Alternative for coding tasks
#
# Setup Instructions:
#   1. Choose your endpoint (X.AI or Z.AI) below
#   2. Set your API key: export GROK_API_KEY="your-key-here"
#   3. Copy this file to: .automatosx/providers/grok.yaml
#   4. Enable in automatosx.config.json: "grok": { "enabled": true }
#   5. Test: ax doctor grok

provider:
  # Provider identification
  name: grok
  enabled: true
  priority: 4                                         # Priority (1=highest, 4=after Claude/Gemini/OpenAI)

  # ====================================================================
  # OPTION 1: X.AI Official Grok (grok-3-fast) - DEFAULT
  # ====================================================================
  # Fast, efficient model for general reasoning and analysis
  baseUrl: https://api.x.ai/v1
  apiKey: ${GROK_API_KEY}                            # Set via: export GROK_API_KEY="xai-..."
  model: grok-3-fast                                  # Fast model (recommended)
  # Alternative models:
  #   - grok-3-fast: Fastest, lowest cost
  #   - grok-beta: Latest features, higher quality
  #   - grok-vision-beta: Image understanding

  # ====================================================================
  # OPTION 2: Z.AI GLM 4.6 (Code-Optimized) - ALTERNATIVE
  # ====================================================================
  # Uncomment lines below and comment out X.AI config above to use GLM 4.6
  # baseUrl: https://api.z.ai/api/coding/paas/v4
  # apiKey: ${GROK_API_KEY}                          # Set via: export GROK_API_KEY="your-z-ai-key"
  # model: glm-4.6                                    # Code-optimized model

  # Performance settings
  timeout: 180000                                     # 3 minutes (adjust based on task complexity)
  maxRetries: 3                                       # Retry on transient failures

  # Optional: Custom CLI path (if grok not in PATH)
  # customPath: /usr/local/bin/grok

# Rate limiting (prevents quota exhaustion)
rateLimits:
  maxRequestsPerMinute: 60                           # API rate limit
  maxTokensPerMinute: 200000                         # Token-based limiting (adjust for your plan)
  maxConcurrentRequests: 5                           # Parallel request limit

# Circuit breaker (prevents cascading failures)
circuitBreaker:
  failureThreshold: 3                                # Open circuit after 3 consecutive failures
  resetTimeout: 60000                                # Wait 60s before retry
  halfOpenTimeout: 30000                             # Test period: 30s

# Cost tracking (optional)
costs:
  # X.AI Grok pricing (as of Nov 2024)
  promptTokenCost: 0.000005                          # $5 per 1M tokens
  completionTokenCost: 0.000015                      # $15 per 1M tokens
  currency: USD

  # Z.AI GLM 4.6 pricing - update based on your plan
  # promptTokenCost: 0.0
  # completionTokenCost: 0.0

# Metadata
metadata:
  version: "8.3.1"
  description: "Grok provider with X.AI (grok-3-fast) and Z.AI (glm-4.6) support"
  tags:
    - grok
    - x-ai
    - z-ai
    - grok-3-fast
    - glm-4.6
    - reasoning
    - code-generation
  lastUpdated: "2025-11-17T01:45:00Z"

# ====================================================================
# Quick Start Guide
# ====================================================================
#
# 1. Get your API key:
#    - X.AI: https://console.x.ai/api-keys (starts with "xai-")
#    - Z.AI: https://z.ai/developer (your Z.AI API key)
#
# 2. Set environment variable:
#    export GROK_API_KEY="xai-your-key-here"
#
# 3. Copy this file:
#    cp examples/providers/grok.yaml .automatosx/providers/grok.yaml
#
# 4. Enable in config:
#    Edit automatosx.config.json:
#    "grok": { "enabled": true, ... }
#
# 5. Verify setup:
#    ax doctor grok
#    ax providers list
#
# 6. Use Grok:
#    ax run backend "implement auth" --provider grok
#
# ====================================================================
# Switching Between X.AI and Z.AI
# ====================================================================
#
# To switch from X.AI (grok-3-fast) to Z.AI (glm-4.6):
#   1. Comment out X.AI config (lines 20-27)
#   2. Uncomment Z.AI config (lines 34-37)
#   3. Update GROK_API_KEY with Z.AI key
#   4. Restart AutomatosX: ax doctor grok
#
# To switch back: reverse the process
#
