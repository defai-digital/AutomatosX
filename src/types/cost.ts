/**
 * Cost Tracking Types
 *
 * Phase 3: Real-time cost tracking with budget management
 *
 * @module types/cost
 */

/**
 * Cost Entry - Single request cost record
 */
export interface CostEntry {
  id?: number;  // Auto-generated by database
  timestamp: number;
  provider: string;
  model: string;
  sessionId?: string;
  agent?: string;
  promptTokens: number;
  completionTokens: number;
  totalTokens: number;
  estimatedCostUsd: number;
  requestId?: string;
}

/**
 * Cost Query - Filter criteria for cost queries
 */
export interface CostQuery {
  provider?: string;
  model?: string;
  sessionId?: string;
  agent?: string;
  startTime?: number;  // Unix timestamp
  endTime?: number;    // Unix timestamp
  limit?: number;
}

/**
 * Cost Breakdown - Aggregated cost statistics
 */
export interface CostBreakdown {
  total: number;
  byProvider: Record<string, number>;
  byModel: Record<string, number>;
  byAgent: Record<string, number>;
  byDay: Record<string, number>;  // YYYY-MM-DD format
  entries: number;  // Total number of entries
}

/**
 * Budget Configuration
 */
export interface BudgetConfig {
  limit: number;            // USD limit
  warningThreshold: number; // 0-1 (e.g., 0.75 = warn at 75%)
}

/**
 * Budget Status
 */
export interface BudgetStatus {
  window: 'daily' | 'weekly' | 'monthly';
  limit: number;
  used: number;
  remaining: number;
  percentUsed: number;
  status: 'ok' | 'warning' | 'critical' | 'exceeded';
  resetAtMs?: number;  // When budget resets
}

/**
 * Cost Tracking Configuration
 */
export interface CostTrackingConfig {
  enabled: boolean;
  persistPath: string;
  budgets?: {
    daily?: BudgetConfig;
    weekly?: BudgetConfig;
    monthly?: BudgetConfig;
  };
  exportEnabled?: boolean;
  alertOnBudget?: boolean;
}

/**
 * Cost Export Format
 */
export type CostExportFormat = 'json' | 'csv';

/**
 * Cost Forecast - Predicted future costs
 */
export interface CostForecast {
  period: 'day' | 'week' | 'month';
  currentSpend: number;
  projectedSpend: number;
  trend: 'increasing' | 'stable' | 'decreasing';
  confidence: number;  // 0-1
}
