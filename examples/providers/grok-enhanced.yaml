# Grok Provider - Enhanced Configuration (v8.6.0+)
#
# This example demonstrates all new CLI flags and features added in v8.6.0.
# This is a YAML provider configuration file that should be loaded via
# the YAML config loader.
#
# Usage:
#   1. Copy to .automatosx/providers/grok.yaml
#   2. Set environment variables: GROK_API_KEY, MORPH_API_KEY (optional)
#   3. Run: ax run --provider grok backend "your task"

provider:
  # Required fields
  name: grok
  enabled: true
  priority: 2
  baseUrl: https://api.x.ai/v1
  apiKey: ${GROK_API_KEY}
  model: grok-3-fast
  timeout: 120000
  maxRetries: 3

  # NEW v8.6.0: Grok-specific configuration
  grok:
    # Model Selection (--model flag)
    # Override the default model for specific tasks
    # Available models: grok-3-fast, grok-4-latest, grok-3-mini-fast, grok-beta
    model: grok-3-fast

    # Max Tool Rounds (--max-tool-rounds flag)
    # Limit the number of tool execution rounds
    # Default: 400, Range: 1-1000
    # Lower values = faster execution, Higher values = more thorough
    maxToolRounds: 500

    # Working Directory (--directory flag)
    # Set the working directory for Grok CLI
    # Useful for scoping file operations
    workingDirectory: ./src

    # Custom CLI Flags
    # Add any additional Grok CLI flags
    # These are passed directly to the CLI
    customFlags:
      - "--verbose"        # Enable verbose output (for debugging)
      # - "--debug"        # Enable debug mode
      # - "--log-level=info"  # Set log level

    # Morph Fast Apply (Phase 2 - Coming Soon)
    # Enable 4,500+ tokens/sec code editing
    # Requires Morph API key
    morphApiKey: ${MORPH_API_KEY}  # Optional, for Phase 2

    # Planning Mode (Phase 3 - Coming Soon)
    # Enable multi-step review before execution
    # Default: false (execute immediately)
    planningMode: false

    # Project Instructions Path (Phase 1.3 - Coming Soon)
    # Path to GROK.md file with project-specific instructions
    # Default: .grok/GROK.md
    projectInstructionsPath: .grok/GROK.md

    # User Settings Path (Phase 1.2 - Coming Soon)
    # Path to global user settings file
    # Default: ~/.grok/user-settings.json
    userSettingsPath: ~/.grok/user-settings.json

# Optional: Rate limits
rateLimits:
  maxRequestsPerMinute: 60
  maxTokensPerMinute: 100000
  maxConcurrentRequests: 5

# Optional: Circuit breaker
circuitBreaker:
  failureThreshold: 3
  resetTimeout: 60000

# Optional: Metadata
metadata:
  version: "8.6.0"
  description: "Grok provider with enhanced CLI flags (v8.6.0)"
  tags:
    - grok
    - enhanced
    - v8.6.0
    - cli-flags
  lastUpdated: "2025-11-18T00:00:00Z"

# ========================================
# Usage Examples
# ========================================

# Example 1: Use specific model
# grok:
#   model: grok-4-latest

# Example 2: Limit tool execution for faster responses
# grok:
#   model: grok-3-fast
#   maxToolRounds: 100

# Example 3: Scope to specific directory
# grok:
#   workingDirectory: ./tests

# Example 4: Full debugging
# grok:
#   model: grok-3-fast
#   maxToolRounds: 500
#   customFlags:
#     - "--verbose"
#     - "--debug"
#     - "--log-level=debug"

# Example 5: Override model via custom flags
# grok:
#   model: grok-3-fast
#   customFlags:
#     - "--model"
#     - "grok-4-latest"  # This will override the above

# ========================================
# Migration from v8.5.8
# ========================================

# Old configuration (still works):
# provider:
#   name: grok
#   enabled: true
#   priority: 2
#   timeout: 120000
#   command: grok

# New configuration (opt-in enhancements):
# provider:
#   name: grok
#   enabled: true
#   priority: 2
#   timeout: 120000
#   command: grok
#   grok:              # NEW! Add this section
#     model: grok-3-fast
#     maxToolRounds: 500

# ========================================
# Notes
# ========================================

# - All grok.* fields are optional
# - Without grok section, behaves like v8.5.8 (backward compatible)
# - Custom flags come last (can override earlier flags)
# - Phase 2/3 fields are placeholders for upcoming features
